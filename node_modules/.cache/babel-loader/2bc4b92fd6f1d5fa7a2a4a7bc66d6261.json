{"ast":null,"code":"var _jsxFileName = \"/home/ogoidmp/dmpdev/projetos-trybe/sd-019-c-project-trivia-react-redux/src/components/Gameplay.jsx\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport { fetchQuestions } from '../services/API';\nimport Answers from './GameplayComponents/Answers';\nimport { timerAction } from '../actions';\n\nclass Gameplay extends Component {\n  constructor() {\n    super();\n\n    this.stopTimer = prevState => {\n      const {\n        currentTime,\n        stop\n      } = this.props;\n      const ZERO = 0;\n      const {\n        timer\n      } = this.state;\n\n      if (prevState.timer !== timer && timer === ZERO) {\n        clearInterval(this.intervalId);\n      }\n\n      if (stop) {\n        clearInterval(this.intervalId);\n        currentTime(timer);\n      }\n    };\n\n    this.state = {\n      questionIndex: 0,\n      timer: 30\n    };\n  }\n\n  componentDidMount() {\n    const {\n      token,\n      fetchingQuestion\n    } = this.props;\n    fetchingQuestion(token);\n    this.startTimer();\n  }\n\n  componentDidUpdate(props, prevState) {\n    this.stopTimer(prevState);\n  }\n\n  startTimer() {\n    const ONE_SECOND = 1000;\n    this.intervalId = setInterval(() => {\n      this.setState(prev => ({\n        timer: prev.timer - 1\n      }));\n    }, ONE_SECOND);\n  }\n\n  render() {\n    const {\n      questions,\n      loading\n    } = this.props;\n    const {\n      questionIndex,\n      timer\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 9\n      }\n    }, timer), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 9\n      }\n    }, loading ? 'Carregando...' : questions.filter((_, index) => index === questionIndex).map(element => /*#__PURE__*/React.createElement(Answers, {\n      key: element.question,\n      category: element.category,\n      question: element.question,\n      correctAnswer: element.correct_answer,\n      incorrectAnswers: element.incorrect_answers,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 34\n      }\n    }))));\n  }\n\n}\n\nGameplay.propTypes = {\n  token: PropTypes.string,\n  question: PropTypes.object,\n  loading: PropTypes.bool\n}.isRequired;\n\nconst mapStateToProps = state => ({\n  token: state.token,\n  questions: state.getQuestions.questions.results,\n  loading: state.getQuestions.loading,\n  stop: state.timer.stop\n});\n\nconst mapDispatchToProps = dispatch => ({\n  fetchingQuestion: token => dispatch(fetchQuestions(token)),\n  currentTime: timer => dispatch(timerAction(timer))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Gameplay);","map":{"version":3,"sources":["/home/ogoidmp/dmpdev/projetos-trybe/sd-019-c-project-trivia-react-redux/src/components/Gameplay.jsx"],"names":["React","Component","connect","PropTypes","fetchQuestions","Answers","timerAction","Gameplay","constructor","stopTimer","prevState","currentTime","stop","props","ZERO","timer","state","clearInterval","intervalId","questionIndex","componentDidMount","token","fetchingQuestion","startTimer","componentDidUpdate","ONE_SECOND","setInterval","setState","prev","render","questions","loading","filter","_","index","map","element","question","category","correct_answer","incorrect_answers","propTypes","string","object","bool","isRequired","mapStateToProps","getQuestions","results","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport { fetchQuestions } from '../services/API';\nimport Answers from './GameplayComponents/Answers';\nimport { timerAction } from '../actions';\n\nclass Gameplay extends Component {\n  constructor() {\n    super();\n    this.state = {\n      questionIndex: 0,\n      timer: 30,\n    };\n  }\n\n  componentDidMount() {\n    const { token, fetchingQuestion } = this.props;\n    fetchingQuestion(token);\n    this.startTimer();\n  }\n\n  componentDidUpdate(props, prevState) {\n    this.stopTimer(prevState);\n  }\n\n  stopTimer = (prevState) => {\n    const { currentTime, stop } = this.props;\n    const ZERO = 0;\n    const { timer } = this.state;\n    if (prevState.timer !== timer && timer === ZERO) {\n      clearInterval(this.intervalId);\n    }\n    if (stop) {\n      clearInterval(this.intervalId);\n      currentTime(timer);\n    }\n  }\n\n  startTimer() {\n    const ONE_SECOND = 1000;\n\n    this.intervalId = setInterval(() => {\n      this.setState((prev) => ({ timer: prev.timer - 1 }));\n    }, ONE_SECOND);\n  }\n\n  render() {\n    const { questions, loading } = this.props;\n    const { questionIndex, timer } = this.state;\n    return (\n      <>\n        <p>{timer}</p>\n        <div>\n          { loading ? 'Carregando...'\n            : questions\n              .filter((_, index) => index === questionIndex)\n              .map((element) => (<Answers\n                key={ element.question }\n                category={ element.category }\n                question={ element.question }\n                correctAnswer={ element.correct_answer }\n                incorrectAnswers={ element.incorrect_answers }\n              />))}\n        </div>\n\n      </>\n    );\n  }\n}\n\nGameplay.propTypes = {\n  token: PropTypes.string,\n  question: PropTypes.object,\n  loading: PropTypes.bool,\n}.isRequired;\n\nconst mapStateToProps = (state) => ({\n  token: state.token,\n  questions: state.getQuestions.questions.results,\n  loading: state.getQuestions.loading,\n  stop: state.timer.stop,\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  fetchingQuestion: (token) => dispatch(fetchQuestions(token)),\n  currentTime: (timer) => dispatch(timerAction(timer)),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Gameplay);\n"]},"metadata":{},"sourceType":"module"}