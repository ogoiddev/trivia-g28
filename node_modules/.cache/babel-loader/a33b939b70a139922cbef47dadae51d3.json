{"ast":null,"code":"var _jsxFileName = \"/home/ogoidmp/dmpdev/projetos-trybe/sd-019-c-project-trivia-react-redux/src/components/Gameplay.jsx\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport { fetchQuestions } from '../services/API';\nimport Answers from './GameplayComponents/Answers';\nimport { timerAction } from '../actions';\n\nclass Gameplay extends Component {\n  constructor() {\n    super();\n\n    this.stopTimer = prevState => {\n      const ZERO = 0;\n      const {\n        timer,\n        isDisabled\n      } = this.state;\n\n      if (prevState.timer !== timer && timer === ZERO) {\n        clearInterval(this.intervalId);\n      }\n\n      if (isDisabled) {\n        clearInterval(this.intervalId);\n      }\n    };\n\n    this.state = {\n      questionIndex: 0,\n      timer: 30,\n      isDisabled: false\n    };\n  }\n\n  componentDidMount() {\n    const {\n      token,\n      fetchingQuestion,\n      dispatch\n    } = this.props;\n    const {\n      timer\n    } = this.state;\n    const ONE_SECOND = 1000;\n    fetchingQuestion(token);\n    this.intervalId = setInterval(() => {\n      this.setState(prev => ({\n        timer: prev.timer - 1\n      }), dispatch(timerAction(timer)));\n    }, ONE_SECOND);\n  }\n\n  componentDidUpdate(props, prevState) {\n    this.stopTimer(prevState);\n  }\n\n  render() {\n    const {\n      questions,\n      loading\n    } = this.props;\n    const {\n      questionIndex,\n      timer\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }\n    }, timer), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }\n    }, loading ? 'Carregando...' : questions.filter((_, index) => index === questionIndex).map(element => /*#__PURE__*/React.createElement(Answers, {\n      key: element.question,\n      category: element.category,\n      question: element.question,\n      correctAnswer: element.correct_answer,\n      incorrectAnswers: element.incorrect_answers,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 34\n      }\n    }))));\n  }\n\n}\n\nGameplay.propTypes = {\n  token: PropTypes.string,\n  question: PropTypes.object,\n  loading: PropTypes.bool\n}.isRequired;\n\nconst mapStateToProps = payload => ({\n  token: payload.token,\n  questions: payload.getQuestions.questions.results,\n  loading: payload.getQuestions.loading\n});\n\nconst mapDispatchToProps = dispatch => ({\n  fetchingQuestion: token => dispatch(fetchQuestions(token))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Gameplay);","map":{"version":3,"sources":["/home/ogoidmp/dmpdev/projetos-trybe/sd-019-c-project-trivia-react-redux/src/components/Gameplay.jsx"],"names":["React","Component","connect","PropTypes","fetchQuestions","Answers","timerAction","Gameplay","constructor","stopTimer","prevState","ZERO","timer","isDisabled","state","clearInterval","intervalId","questionIndex","componentDidMount","token","fetchingQuestion","dispatch","props","ONE_SECOND","setInterval","setState","prev","componentDidUpdate","render","questions","loading","filter","_","index","map","element","question","category","correct_answer","incorrect_answers","propTypes","string","object","bool","isRequired","mapStateToProps","payload","getQuestions","results","mapDispatchToProps"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,cAAT,QAA+B,iBAA/B;AACA,OAAOC,OAAP,MAAoB,8BAApB;AACA,SAASC,WAAT,QAA4B,YAA5B;;AAEA,MAAMC,QAAN,SAAuBN,SAAvB,CAAiC;AAC/BO,EAAAA,WAAW,GAAG;AACZ;;AADY,SAyBdC,SAzBc,GAyBDC,SAAD,IAAe;AACzB,YAAMC,IAAI,GAAG,CAAb;AACA,YAAM;AAAEC,QAAAA,KAAF;AAASC,QAAAA;AAAT,UAAwB,KAAKC,KAAnC;;AACA,UAAIJ,SAAS,CAACE,KAAV,KAAoBA,KAApB,IAA6BA,KAAK,KAAKD,IAA3C,EAAiD;AAC/CI,QAAAA,aAAa,CAAC,KAAKC,UAAN,CAAb;AACD;;AACD,UAAIH,UAAJ,EAAgB;AACdE,QAAAA,aAAa,CAAC,KAAKC,UAAN,CAAb;AACD;AACF,KAlCa;;AAEZ,SAAKF,KAAL,GAAa;AACXG,MAAAA,aAAa,EAAE,CADJ;AAEXL,MAAAA,KAAK,EAAE,EAFI;AAGXC,MAAAA,UAAU,EAAE;AAHD,KAAb;AAKD;;AAEDK,EAAAA,iBAAiB,GAAG;AAClB,UAAM;AAAEC,MAAAA,KAAF;AAASC,MAAAA,gBAAT;AAA2BC,MAAAA;AAA3B,QAAwC,KAAKC,KAAnD;AACA,UAAM;AAAEV,MAAAA;AAAF,QAAY,KAAKE,KAAvB;AACA,UAAMS,UAAU,GAAG,IAAnB;AAEAH,IAAAA,gBAAgB,CAACD,KAAD,CAAhB;AAEA,SAAKH,UAAL,GAAkBQ,WAAW,CAAC,MAAM;AAClC,WAAKC,QAAL,CAAeC,IAAD,KAAW;AAAEd,QAAAA,KAAK,EAAEc,IAAI,CAACd,KAAL,GAAa;AAAtB,OAAX,CAAd,EAAqDS,QAAQ,CAACf,WAAW,CAACM,KAAD,CAAZ,CAA7D;AACD,KAF4B,EAE1BW,UAF0B,CAA7B;AAGD;;AAEDI,EAAAA,kBAAkB,CAACL,KAAD,EAAQZ,SAAR,EAAmB;AACnC,SAAKD,SAAL,CAAeC,SAAf;AACD;;AAaDkB,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEC,MAAAA,SAAF;AAAaC,MAAAA;AAAb,QAAyB,KAAKR,KAApC;AACA,UAAM;AAAEL,MAAAA,aAAF;AAAiBL,MAAAA;AAAjB,QAA2B,KAAKE,KAAtC;AACA,wBACE,uDACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAIF,KAAJ,CADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACIkB,OAAO,GAAG,eAAH,GACLD,SAAS,CACRE,MADD,CACQ,CAACC,CAAD,EAAIC,KAAJ,KAAcA,KAAK,KAAKhB,aADhC,EAECiB,GAFD,CAEMC,OAAD,iBAAc,oBAAC,OAAD;AACjB,MAAA,GAAG,EAAGA,OAAO,CAACC,QADG;AAEjB,MAAA,QAAQ,EAAGD,OAAO,CAACE,QAFF;AAGjB,MAAA,QAAQ,EAAGF,OAAO,CAACC,QAHF;AAIjB,MAAA,aAAa,EAAGD,OAAO,CAACG,cAJP;AAKjB,MAAA,gBAAgB,EAAGH,OAAO,CAACI,iBALV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFnB,CAFN,CAFF,CADF;AAiBD;;AAzD8B;;AA4DjChC,QAAQ,CAACiC,SAAT,GAAqB;AACnBrB,EAAAA,KAAK,EAAEhB,SAAS,CAACsC,MADE;AAEnBL,EAAAA,QAAQ,EAAEjC,SAAS,CAACuC,MAFD;AAGnBZ,EAAAA,OAAO,EAAE3B,SAAS,CAACwC;AAHA,EAInBC,UAJF;;AAMA,MAAMC,eAAe,GAAIC,OAAD,KAAc;AACpC3B,EAAAA,KAAK,EAAE2B,OAAO,CAAC3B,KADqB;AAEpCU,EAAAA,SAAS,EAAEiB,OAAO,CAACC,YAAR,CAAqBlB,SAArB,CAA+BmB,OAFN;AAGpClB,EAAAA,OAAO,EAAEgB,OAAO,CAACC,YAAR,CAAqBjB;AAHM,CAAd,CAAxB;;AAMA,MAAMmB,kBAAkB,GAAI5B,QAAD,KAAe;AACxCD,EAAAA,gBAAgB,EAAGD,KAAD,IAAWE,QAAQ,CAACjB,cAAc,CAACe,KAAD,CAAf;AADG,CAAf,CAA3B;;AAIA,eAAejB,OAAO,CAAC2C,eAAD,EAAkBI,kBAAlB,CAAP,CAA6C1C,QAA7C,CAAf","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport { fetchQuestions } from '../services/API';\nimport Answers from './GameplayComponents/Answers';\nimport { timerAction } from '../actions';\n\nclass Gameplay extends Component {\n  constructor() {\n    super();\n    this.state = {\n      questionIndex: 0,\n      timer: 30,\n      isDisabled: false,\n    };\n  }\n\n  componentDidMount() {\n    const { token, fetchingQuestion, dispatch } = this.props;\n    const { timer } = this.state;\n    const ONE_SECOND = 1000;\n\n    fetchingQuestion(token);\n\n    this.intervalId = setInterval(() => {\n      this.setState((prev) => ({ timer: prev.timer - 1 }), dispatch(timerAction(timer)));\n    }, ONE_SECOND);\n  }\n\n  componentDidUpdate(props, prevState) {\n    this.stopTimer(prevState);\n  }\n\n  stopTimer = (prevState) => {\n    const ZERO = 0;\n    const { timer, isDisabled } = this.state;\n    if (prevState.timer !== timer && timer === ZERO) {\n      clearInterval(this.intervalId);\n    }\n    if (isDisabled) {\n      clearInterval(this.intervalId);\n    }\n  }\n\n  render() {\n    const { questions, loading } = this.props;\n    const { questionIndex, timer } = this.state;\n    return (\n      <>\n        <p>{timer}</p>\n        <div>\n          { loading ? 'Carregando...'\n            : questions\n              .filter((_, index) => index === questionIndex)\n              .map((element) => (<Answers\n                key={ element.question }\n                category={ element.category }\n                question={ element.question }\n                correctAnswer={ element.correct_answer }\n                incorrectAnswers={ element.incorrect_answers }\n              />))}\n        </div>\n      </>\n    );\n  }\n}\n\nGameplay.propTypes = {\n  token: PropTypes.string,\n  question: PropTypes.object,\n  loading: PropTypes.bool,\n}.isRequired;\n\nconst mapStateToProps = (payload) => ({\n  token: payload.token,\n  questions: payload.getQuestions.questions.results,\n  loading: payload.getQuestions.loading,\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  fetchingQuestion: (token) => dispatch(fetchQuestions(token)),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Gameplay);\n"]},"metadata":{},"sourceType":"module"}